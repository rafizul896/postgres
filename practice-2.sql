CREATE TABLE orders (
    order_id SERIAL PRIMARY KEY,
    customer_id INT,
    order_date DATE,
    total_amount DECIMAL(10,2)
)

INSERT INTO orders (customer_id, order_date, total_amount)
VALUES
(1, '2022-01-01', 150.75),
(2, '2023-01-03', 230.00),
(3, '2022-01-05', 99.99),
(4, '2023-01-07', 320.50),
(5, '2023-01-08', 180.25),
(6, '2022-01-10', 275.00),
(7, '2023-01-12', 420.90),
(8, '2023-01-13', 60.75),
(9, '2023-01-15', 510.00),
(10, '2022-01-17', 330.40),
(11, '2023-01-18', 120.00),
(12, '2022-01-20', 245.50),
(13, '2022-01-22', 410.75),
(14, '2023-01-23', 99.95),
(15, '2022-01-25', 315.25),
(16, '2023-01-27', 199.99),
(17, '2023-01-29', 150.00),
(18, '2022-01-30', 270.80),
(19, '2022-02-01', 305.45),
(20, '2023-02-02', 100.00),
(1, '2022-02-03', 99.99),
(2, '2023-02-04', 210.00),
(3, '2022-02-05', 175.25),
(4, '2023-02-06', 450.75),
(5, '2023-02-07', 160.00),
(6, '2022-02-08', 205.65),
(7, '2023-02-09', 395.90),
(8, '2023-02-10', 150.10),
(9, '2023-02-11', 610.40),
(10, '2022-02-12', 300.00),
(11, '2023-02-13', 89.90),
(12, '2023-02-14', 240.00),
(13, '2023-02-15', 350.35),
(14, '2023-02-16', 190.99),
(15, '2023-02-17', 425.00),
(16, '2023-02-18', 215.45),
(17, '2023-02-19', 185.30),
(18, '2022-02-20', 290.00),
(19, '2023-02-21', 305.25),
(20, '2023-02-22', 450.75),
(1, '2023-02-23', 270.00),
(2, '2022-02-24', 150.50),
(3, '2023-02-25', 180.00),
(4, '2023-02-26', 99.99),
(5, '2023-02-27', 320.30),
(6, '2023-02-28', 190.00),
(7, '2023-03-01', 300.00),
(8, '2023-03-02', 260.60),
(9, '2023-03-03', 110.00),
(10, '2022-03-04', 350.25);

DROP TABLE orders

SELECT * FROM orders;

SELECT customer_id,count(order_id),sum(total_amount) FROM orders
    GROUP BY customer_id
    HAVING count(order_id) > 2;

SELECT extract(month FROM order_date) as month,sum(total_amount) FROM orders
    WHERE extract(YEAR FROM order_date) = 2022
    GROUP BY month;


